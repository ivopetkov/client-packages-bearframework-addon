<?php

/*
 * Client packages addon for Bear Framework
 * https://github.com/ivopetkov/client-packages-bearframework-addon
 * Copyright (c) Ivo Petkov
 * Free to use under the MIT license.
 */

return <<<'EOT'
var clientPackages=clientPackages||function(){var n=[];Promise=window.Promise||function(n){var t=[],e=null;this.then=function(n){return t.push(n),this},this.catch=function(n){return null===e&&(e=n),this};var i=function(){for(var n in t)t[n].apply(null,arguments)},o=function(){null!==e&&e.apply(null,arguments)};window.setTimeout((function(){n(i,o)}),16)};var t=function(t){var e=new XMLHttpRequest;e.onreadystatechange=function(){if(4===e.readyState){if(200===e.status)return void new Function(e.responseText)();n[t][0]=-1;for(var i=null;void 0!==(i=n[t][2].shift());)i[1]()}},e.timeout=1e3*timeout,e.open("POST","URL_TO_REPLACE?n="+t,!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.send("")},e=function(t,e){e(new Function(n[t][1])())};return{get:function(i,o){return new Promise((function(u,r){var a=function(){n[i][2].push([u,r])};void 0===o&&(o={});void 0!==o.timeout&&o.timeout;void 0===n[i]?(n[i]=[0,null,[]],a(),t(i)):1===n[i][0]?e(i,u):2===n[i][0]?(a(),new Function(n[i][3])(),delete n[i][3]):(a(),-1===n[i][0]&&(n[i][0]=0,t(i)))}))},__a:function(t,i){void 0===n[t]?n[t]=[1,i,[]]:(n[t][0]=1,n[t][1]=i);for(var o=null;void 0!==(o=n[t][2].shift());)e(t,o[0])},__p:function(t,e){void 0===n[t]&&(n[t]=[2,null,[],e])}}}();
EOT;
